{
  "node_id": "n8n-nodes-base.airtableTool",
  "name": "n8n-nodes-base.airtableTool",
  "version": [
    2,
    2.1
  ],
  "semantic_context": "Read, update, write and delete data from Airtable",
  "parameters": {
    "descriptionType": {
      "displayName": "Tool Description",
      "name": "descriptionType",
      "type": "options",
      "noDataExpression": true,
      "options": [
        {
          "name": "Set Automatically",
          "value": "auto",
          "description": "Automatically set based on resource and operation"
        },
        {
          "name": "Set Manually",
          "value": "manual",
          "description": "Manually set the description"
        }
      ],
      "default": "auto",
      "ai_hint": "根据 REST 规范选择方法: 查询用 GET，创建用 POST，更新用 PUT/PATCH。"
    },
    "toolDescription": {
      "displayName": "Description",
      "name": "toolDescription",
      "type": "string",
      "default": "Read, update, write and delete data from Airtable",
      "required": true,
      "typeOptions": {
        "rows": 2
      },
      "description": "Explain to the LLM what this tool does, a good, specific description would allow LLMs to produce expected results much more often",
      "displayOptions": {
        "show": {
          "descriptionType": [
            "manual"
          ]
        }
      },
      "ai_hint": "Explain to the LLM what this tool does, a good, specific description would allow LLMs to produce expected results much more often"
    },
    "authentication": {
      "displayName": "Authentication",
      "name": "authentication",
      "type": "options",
      "options": [
        {
          "name": "Access Token",
          "value": "airtableTokenApi"
        },
        {
          "name": "OAuth2",
          "value": "airtableOAuth2Api"
        }
      ],
      "default": "airtableTokenApi",
      "ai_hint": "根据 REST 规范选择方法: 查询用 GET，创建用 POST，更新用 PUT/PATCH。 与鉴权相关，注意不要在公共日志中输出敏感信息。"
    },
    "resource": {
      "displayName": "Resource",
      "name": "resource",
      "type": "options",
      "noDataExpression": true,
      "options": [
        {
          "name": "Base",
          "value": "base"
        },
        {
          "name": "Record",
          "value": "record"
        }
      ],
      "default": "record",
      "ai_hint": "根据 REST 规范选择方法: 查询用 GET，创建用 POST，更新用 PUT/PATCH。"
    },
    "operation": {
      "displayName": "Operation",
      "name": "operation",
      "type": "options",
      "noDataExpression": true,
      "options": [
        {
          "name": "Get Many",
          "value": "getMany",
          "description": "List all the bases",
          "action": "Get many bases"
        },
        {
          "name": "Get Schema",
          "value": "getSchema",
          "description": "Get the schema of the tables in a base",
          "action": "Get base schema"
        }
      ],
      "default": "getMany",
      "displayOptions": {
        "show": {
          "resource": [
            "base"
          ]
        }
      },
      "ai_hint": "根据 REST 规范选择方法: 查询用 GET，创建用 POST，更新用 PUT/PATCH。"
    },
    "base": {
      "displayName": "Base",
      "name": "base",
      "type": "resourceLocator",
      "default": {
        "mode": "list",
        "value": ""
      },
      "required": true,
      "modes": [
        {
          "displayName": "From List",
          "name": "list",
          "type": "list",
          "typeOptions": {
            "searchListMethod": "baseSearch",
            "searchable": true
          }
        },
        {
          "displayName": "By URL",
          "name": "url",
          "type": "string",
          "placeholder": "e.g. https://airtable.com/app12DiScdfes/tbl9WvGeEPa6lZyVq/viwHdfasdfeieg5p",
          "validation": [
            {
              "type": "regex",
              "properties": {
                "regex": "https://airtable.com/([a-zA-Z0-9]{2,})/.*",
                "errorMessage": "Not a valid Airtable Base URL"
              }
            }
          ],
          "extractValue": {
            "type": "regex",
            "regex": "https://airtable.com/([a-zA-Z0-9]{2,})"
          }
        },
        {
          "displayName": "ID",
          "name": "id",
          "type": "string",
          "validation": [
            {
              "type": "regex",
              "properties": {
                "regex": "[a-zA-Z0-9]{2,}",
                "errorMessage": "Not a valid Airtable Base ID"
              }
            }
          ],
          "placeholder": "e.g. appD3dfaeidke",
          "url": "=https://airtable.com/{{$value}}"
        }
      ],
      "description": "The Airtable Base to retrieve the schema from",
      "displayOptions": {
        "show": {
          "resource": [
            "base"
          ],
          "operation": [
            "getSchema"
          ]
        }
      },
      "ai_hint": "The Airtable Base to retrieve the schema from"
    },
    "table": {
      "displayName": "Table",
      "name": "table",
      "type": "resourceLocator",
      "default": {
        "mode": "list",
        "value": ""
      },
      "required": true,
      "typeOptions": {
        "loadOptionsDependsOn": [
          "base.value"
        ]
      },
      "modes": [
        {
          "displayName": "From List",
          "name": "list",
          "type": "list",
          "typeOptions": {
            "searchListMethod": "tableSearch",
            "searchable": true
          }
        },
        {
          "displayName": "By URL",
          "name": "url",
          "type": "string",
          "placeholder": "https://airtable.com/app12DiScdfes/tblAAAAAAAAAAAAA/viwHdfasdfeieg5p",
          "validation": [
            {
              "type": "regex",
              "properties": {
                "regex": "https://airtable.com/[a-zA-Z0-9]{2,}/([a-zA-Z0-9]{2,})/.*",
                "errorMessage": "Not a valid Airtable Table URL"
              }
            }
          ],
          "extractValue": {
            "type": "regex",
            "regex": "https://airtable.com/[a-zA-Z0-9]{2,}/([a-zA-Z0-9]{2,})"
          }
        },
        {
          "displayName": "ID",
          "name": "id",
          "type": "string",
          "validation": [
            {
              "type": "regex",
              "properties": {
                "regex": "[a-zA-Z0-9]{2,}",
                "errorMessage": "Not a valid Airtable Table ID"
              }
            }
          ],
          "placeholder": "tbl3dirwqeidke"
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "record"
          ]
        }
      }
    },
    "columns": {
      "displayName": "Columns",
      "name": "columns",
      "type": "resourceMapper",
      "noDataExpression": true,
      "default": {
        "mappingMode": "defineBelow",
        "value": null
      },
      "required": true,
      "typeOptions": {
        "loadOptionsDependsOn": [
          "table.value",
          "base.value"
        ],
        "resourceMapper": {
          "resourceMapperMethod": "getColumnsWithRecordId",
          "mode": "update",
          "fieldWords": {
            "singular": "column",
            "plural": "columns"
          },
          "addAllFields": true,
          "multiKeyMatch": true
        }
      },
      "displayOptions": {
        "show": {
          "resource": [
            "record"
          ],
          "operation": [
            "upsert"
          ]
        }
      }
    },
    "options": {
      "displayName": "Options",
      "name": "options",
      "type": "collection",
      "placeholder": "Add option",
      "default": {},
      "options": [
        {
          "displayName": "Permission Level",
          "name": "permissionLevel",
          "type": "multiOptions",
          "options": [
            {
              "name": "Comment",
              "value": "comment"
            },
            {
              "name": "Create",
              "value": "create"
            },
            {
              "name": "Edit",
              "value": "edit"
            },
            {
              "name": "None",
              "value": "none"
            },
            {
              "name": "Read",
              "value": "read"
            }
          ],
          "default": [],
          "description": "Filter the returned bases by one or more permission levels"
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "base"
          ],
          "operation": [
            "getMany"
          ]
        }
      },
      "ai_hint": "此参数为 fixedCollection，包含嵌套字段，不要扁平化。"
    },
    "id": {
      "displayName": "Record ID",
      "name": "id",
      "type": "string",
      "default": "",
      "placeholder": "e.g. recf7EaZp707CEc8g",
      "required": true,
      "description": "ID of the record to get. <a href=\"https://support.airtable.com/docs/record-id\" target=\"_blank\">More info</a>.",
      "displayOptions": {
        "show": {
          "resource": [
            "record"
          ],
          "operation": [
            "get"
          ]
        }
      },
      "ai_hint": "ID of the record to get. <a href=\"https://support.airtable.com/docs/record-id\" target=\"_blank\">More info</a>."
    },
    "filterByFormula": {
      "displayName": "Filter By Formula",
      "name": "filterByFormula",
      "type": "string",
      "default": "",
      "placeholder": "e.g. NOT({Name} = 'Admin')",
      "hint": "If empty, all the records will be returned",
      "description": "The formula will be evaluated for each record, and if the result is not 0, false, \"\", NaN, [], or #Error! the record will be included in the response. <a href=\"https://support.airtable.com/docs/formula-field-reference\" target=\"_blank\">More info</a>.",
      "displayOptions": {
        "show": {
          "resource": [
            "record"
          ],
          "operation": [
            "search"
          ]
        }
      },
      "ai_hint": "The formula will be evaluated for each record, and if the result is not 0, false, \"\", NaN, [], or #Error! the record will be included in the response. <a href=\"https://support.airtable.com/docs/formula-field-reference\" target=\"_blank\">More info</a>."
    },
    "returnAll": {
      "displayName": "Return All",
      "name": "returnAll",
      "type": "boolean",
      "default": true,
      "description": "Whether to return all results or only up to a given limit",
      "displayOptions": {
        "show": {
          "resource": [
            "base"
          ],
          "operation": [
            "getMany"
          ]
        }
      },
      "ai_hint": "布尔值：true 或 false。"
    },
    "limit": {
      "displayName": "Limit",
      "name": "limit",
      "type": "number",
      "displayOptions": {
        "show": {
          "returnAll": [
            false
          ],
          "resource": [
            "base"
          ],
          "operation": [
            "getMany"
          ]
        }
      },
      "typeOptions": {
        "minValue": 1,
        "maxValue": 100
      },
      "default": 100,
      "description": "Max number of results to return",
      "ai_hint": "Max number of results to return"
    },
    "sort": {
      "displayName": "Sort",
      "name": "sort",
      "placeholder": "Add Sort Rule",
      "description": "Defines how the returned records should be ordered",
      "type": "fixedCollection",
      "typeOptions": {
        "multipleValues": true
      },
      "default": {},
      "options": [
        {
          "name": "property",
          "displayName": "Property",
          "values": [
            {
              "displayName": "Field",
              "name": "field",
              "type": "options",
              "typeOptions": {
                "loadOptionsMethod": "getColumns",
                "loadOptionsDependsOn": [
                  "base.value",
                  "table.value"
                ]
              },
              "default": "",
              "description": "Name of the field to sort on. Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>."
            },
            {
              "displayName": "Direction",
              "name": "direction",
              "type": "options",
              "options": [
                {
                  "name": "ASC",
                  "value": "asc",
                  "description": "Sort in ascending order (small -> large)"
                },
                {
                  "name": "DESC",
                  "value": "desc",
                  "description": "Sort in descending order (large -> small)"
                }
              ],
              "default": "asc",
              "description": "The sort direction"
            }
          ]
        }
      ],
      "displayOptions": {
        "show": {
          "resource": [
            "record"
          ],
          "operation": [
            "search"
          ]
        }
      },
      "ai_hint": "此参数为 fixedCollection，包含嵌套字段，不要扁平化。"
    }
  },
  "configuration_logic": {
    "required_sequence": [
      "descriptionType",
      "toolDescription",
      "authentication",
      "resource",
      "operation",
      "base",
      "table",
      "columns",
      "options",
      "id",
      "id",
      "options",
      "filterByFormula",
      "returnAll",
      "limit",
      "options",
      "sort",
      "columns",
      "options",
      "columns",
      "options",
      "operation",
      "returnAll",
      "limit",
      "options",
      "base"
    ],
    "conditional_rules": [
      "IF descriptionType == 'manual' THEN SHOW parameter 'toolDescription'",
      "IF resource == 'record' THEN SHOW parameter 'operation'",
      "IF resource == 'record' THEN SHOW parameter 'base'",
      "IF resource == 'record' THEN SHOW parameter 'table'",
      "IF resource == 'record' AND operation == 'create' THEN SHOW parameter 'columns'",
      "IF resource == 'record' AND operation == 'create' THEN SHOW parameter 'options'",
      "IF /columns.mappingMode == 'autoMapInputData' THEN SHOW parameter 'ignoreFields'",
      "IF /operation IN [\"update\", \"upsert\"] THEN SHOW parameter 'updateAllMatches'",
      "IF resource == 'record' AND operation == 'deleteRecord' THEN SHOW parameter 'id'",
      "IF resource == 'record' AND operation == 'get' THEN SHOW parameter 'id'",
      "IF resource == 'record' AND operation == 'get' THEN SHOW parameter 'options'",
      "IF resource == 'record' AND operation == 'search' THEN SHOW parameter 'filterByFormula'",
      "IF resource == 'record' AND operation == 'search' THEN SHOW parameter 'returnAll'",
      "IF returnAll == False AND resource == 'record' AND operation == 'search' THEN SHOW parameter 'limit'",
      "IF resource == 'record' AND operation == 'search' THEN SHOW parameter 'options'",
      "IF resource == 'record' AND operation == 'search' THEN SHOW parameter 'sort'",
      "IF resource == 'record' AND operation == 'update' THEN SHOW parameter 'columns'",
      "IF resource == 'record' AND operation == 'update' THEN SHOW parameter 'options'",
      "IF resource == 'record' AND operation == 'upsert' THEN SHOW parameter 'columns'",
      "IF resource == 'record' AND operation == 'upsert' THEN SHOW parameter 'options'",
      "IF resource == 'base' THEN SHOW parameter 'operation'",
      "IF resource == 'base' AND operation == 'getMany' THEN SHOW parameter 'returnAll'",
      "IF returnAll == False AND resource == 'base' AND operation == 'getMany' THEN SHOW parameter 'limit'",
      "IF resource == 'base' AND operation == 'getMany' THEN SHOW parameter 'options'",
      "IF resource == 'base' AND operation == 'getSchema' THEN SHOW parameter 'base'"
    ]
  }
}