{
  "node_id": "n8n-nodes-base.microsoftSharePointTool",
  "name": "n8n-nodes-base.microsoftSharePointTool",
  "version": 1,
  "semantic_context": "Interact with Microsoft SharePoint API",
  "parameters": {
    "descriptionType": {
      "displayName": "Tool Description",
      "name": "descriptionType",
      "type": "options",
      "noDataExpression": true,
      "options": [
        {
          "name": "Set Automatically",
          "value": "auto",
          "description": "Automatically set based on resource and operation"
        },
        {
          "name": "Set Manually",
          "value": "manual",
          "description": "Manually set the description"
        }
      ],
      "default": "auto",
      "ai_hint": "根据 REST 规范选择方法: 查询用 GET，创建用 POST，更新用 PUT/PATCH。"
    },
    "toolDescription": {
      "displayName": "Description",
      "name": "toolDescription",
      "type": "string",
      "default": "Interact with Microsoft SharePoint API",
      "required": true,
      "typeOptions": {
        "rows": 2
      },
      "description": "Explain to the LLM what this tool does, a good, specific description would allow LLMs to produce expected results much more often",
      "displayOptions": {
        "show": {
          "descriptionType": [
            "manual"
          ]
        }
      },
      "ai_hint": "Explain to the LLM what this tool does, a good, specific description would allow LLMs to produce expected results much more often"
    },
    "resource": {
      "displayName": "Resource",
      "name": "resource",
      "type": "options",
      "noDataExpression": true,
      "options": [
        {
          "name": "File",
          "value": "file"
        },
        {
          "name": "Item",
          "value": "item"
        },
        {
          "name": "List",
          "value": "list"
        }
      ],
      "default": "file",
      "ai_hint": "根据 REST 规范选择方法: 查询用 GET，创建用 POST，更新用 PUT/PATCH。"
    },
    "operation": {
      "displayName": "Operation",
      "name": "operation",
      "type": "options",
      "noDataExpression": true,
      "displayOptions": {
        "show": {
          "resource": [
            "list"
          ]
        }
      },
      "options": [
        {
          "name": "Get",
          "value": "get",
          "description": "Retrieve details of a single list",
          "routing": {
            "request": {
              "ignoreHttpStatusErrors": true,
              "method": "GET",
              "url": "=/sites/{{ $parameter[\"site\"] }}/lists/{{ $parameter[\"list\"] }}"
            },
            "output": {
              "postReceive": [
                null,
                null
              ]
            }
          },
          "action": "Get list"
        },
        {
          "name": "Get Many",
          "value": "getAll",
          "description": "Retrieve a list of lists",
          "routing": {
            "request": {
              "method": "GET",
              "url": "=/sites/{{ $parameter[\"site\"] }}/lists"
            },
            "output": {
              "postReceive": [
                null,
                {
                  "type": "rootProperty",
                  "properties": {
                    "property": "value"
                  }
                },
                null
              ]
            }
          },
          "action": "Get many lists"
        }
      ],
      "default": "getAll",
      "ai_hint": "根据 REST 规范选择方法: 查询用 GET，创建用 POST，更新用 PUT/PATCH。"
    },
    "site": {
      "displayName": "Site",
      "name": "site",
      "default": {
        "mode": "list",
        "value": ""
      },
      "description": "Select the site to retrieve lists from",
      "modes": [
        {
          "displayName": "From List",
          "name": "list",
          "type": "list",
          "typeOptions": {
            "searchListMethod": "getSites",
            "searchable": true
          }
        },
        {
          "displayName": "By ID",
          "name": "id",
          "placeholder": "e.g. mysite",
          "type": "string"
        }
      ],
      "required": true,
      "type": "resourceLocator",
      "displayOptions": {
        "show": {
          "resource": [
            "list"
          ],
          "operation": [
            "getAll"
          ]
        }
      },
      "ai_hint": "Select the site to retrieve lists from"
    },
    "folder": {
      "displayName": "Parent Folder",
      "name": "folder",
      "default": {
        "mode": "list",
        "value": ""
      },
      "description": "Select the folder to upload the file to",
      "modes": [
        {
          "displayName": "From List",
          "name": "list",
          "type": "list",
          "typeOptions": {
            "searchListMethod": "getFolders",
            "searchable": true
          }
        },
        {
          "displayName": "By ID",
          "name": "id",
          "placeholder": "e.g. myfolder",
          "type": "string"
        }
      ],
      "placeholder": "/ (Library root)",
      "required": true,
      "type": "resourceLocator",
      "displayOptions": {
        "hide": {
          "site": [
            ""
          ]
        },
        "show": {
          "resource": [
            "file"
          ],
          "operation": [
            "upload"
          ]
        }
      },
      "ai_hint": "Select the folder to upload the file to"
    },
    "file": {
      "displayName": "File",
      "name": "file",
      "default": {
        "mode": "list",
        "value": ""
      },
      "description": "Select the file to update",
      "modes": [
        {
          "displayName": "From List",
          "name": "list",
          "type": "list",
          "typeOptions": {
            "searchListMethod": "getFiles",
            "searchable": true
          }
        },
        {
          "displayName": "By ID",
          "name": "id",
          "placeholder": "e.g. mysite",
          "type": "string"
        }
      ],
      "placeholder": "eg. my-file.pdf",
      "required": true,
      "type": "resourceLocator",
      "displayOptions": {
        "hide": {
          "site": [
            ""
          ],
          "folder": [
            ""
          ]
        },
        "show": {
          "resource": [
            "file"
          ],
          "operation": [
            "update"
          ]
        }
      },
      "ai_hint": "Select the file to update"
    },
    "fileName": {
      "displayName": "File Name",
      "name": "fileName",
      "default": "",
      "description": "The name of the file being uploaded",
      "placeholder": "e.g. My New File",
      "required": true,
      "type": "string",
      "displayOptions": {
        "show": {
          "resource": [
            "file"
          ],
          "operation": [
            "upload"
          ]
        }
      },
      "ai_hint": "The name of the file being uploaded"
    },
    "changeFileContent": {
      "displayName": "Change File Content",
      "name": "changeFileContent",
      "default": false,
      "description": "Whether to update the file contents",
      "placeholder": "e.g. My New File",
      "required": true,
      "type": "boolean",
      "displayOptions": {
        "show": {
          "resource": [
            "file"
          ],
          "operation": [
            "update"
          ]
        }
      },
      "ai_hint": "布尔值：true 或 false。"
    },
    "fileContents": {
      "displayName": "File Contents",
      "name": "fileContents",
      "default": "",
      "description": "Find the name of input field containing the binary data to upload in the Input panel on the left, in the Binary tab",
      "hint": "The name of the input field containing the binary file data to upload",
      "placeholder": "data",
      "required": true,
      "routing": {
        "send": {
          "preSend": [
            null
          ]
        }
      },
      "type": "string",
      "displayOptions": {
        "show": {
          "resource": [
            "file"
          ],
          "operation": [
            "upload"
          ]
        }
      },
      "ai_hint": "Find the name of input field containing the binary data to upload in the Input panel on the left, in the Binary tab"
    },
    "list": {
      "displayName": "List",
      "name": "list",
      "default": {
        "mode": "list",
        "value": ""
      },
      "description": "Select the list you want to retrieve",
      "modes": [
        {
          "displayName": "From List",
          "name": "list",
          "type": "list",
          "typeOptions": {
            "searchListMethod": "getLists",
            "searchable": true
          }
        },
        {
          "displayName": "By ID",
          "name": "id",
          "placeholder": "e.g. mylist",
          "type": "string"
        }
      ],
      "required": true,
      "type": "resourceLocator",
      "displayOptions": {
        "hide": {
          "site": [
            ""
          ]
        },
        "show": {
          "resource": [
            "list"
          ],
          "operation": [
            "get"
          ]
        }
      },
      "ai_hint": "Select the list you want to retrieve"
    },
    "noticeUnsupportedFields": {
      "displayName": "Due to API restrictions, the following column types cannot be updated: Hyperlink, Location, Metadata",
      "name": "noticeUnsupportedFields",
      "displayOptions": {
        "hide": {
          "site": [
            ""
          ],
          "list": [
            ""
          ]
        },
        "show": {
          "resource": [
            "item"
          ],
          "operation": [
            "upsert"
          ]
        }
      },
      "type": "notice",
      "default": ""
    },
    "columns": {
      "displayName": "Columns",
      "name": "columns",
      "default": {
        "mappingMode": "defineBelow",
        "value": null
      },
      "displayOptions": {
        "hide": {
          "site": [
            ""
          ],
          "list": [
            ""
          ]
        },
        "show": {
          "resource": [
            "item"
          ],
          "operation": [
            "upsert"
          ]
        }
      },
      "noDataExpression": true,
      "required": true,
      "routing": {
        "send": {
          "preSend": [
            null
          ]
        }
      },
      "type": "resourceMapper",
      "typeOptions": {
        "loadOptionsDependsOn": [
          "site.value",
          "list.value"
        ],
        "resourceMapper": {
          "resourceMapperMethod": "getMappingColumns",
          "mode": "upsert",
          "fieldWords": {
            "singular": "column",
            "plural": "columns"
          },
          "addAllFields": true,
          "multiKeyMatch": false
        }
      }
    },
    "item": {
      "displayName": "Item",
      "name": "item",
      "default": {
        "mode": "list",
        "value": ""
      },
      "description": "Select the item you want to get",
      "modes": [
        {
          "displayName": "From List",
          "name": "list",
          "type": "list",
          "typeOptions": {
            "searchListMethod": "getItems",
            "searchable": true
          }
        },
        {
          "displayName": "By ID",
          "name": "id",
          "placeholder": "e.g. 1",
          "type": "string"
        }
      ],
      "required": true,
      "type": "resourceLocator",
      "displayOptions": {
        "hide": {
          "site": [
            ""
          ],
          "list": [
            ""
          ]
        },
        "show": {
          "resource": [
            "item"
          ],
          "operation": [
            "get"
          ]
        }
      },
      "ai_hint": "Select the item you want to get"
    },
    "simplify": {
      "displayName": "Simplify",
      "name": "simplify",
      "default": true,
      "routing": {
        "send": {
          "property": "$select",
          "type": "query",
          "value": "={{ $value ? \"id,name,displayName,description,createdDateTime,lastModifiedDateTime,webUrl\" : undefined }}"
        }
      },
      "type": "boolean",
      "displayOptions": {
        "show": {
          "resource": [
            "list"
          ],
          "operation": [
            "getAll"
          ]
        }
      },
      "ai_hint": "布尔值：true 或 false。"
    },
    "filter": {
      "displayName": "Filter by Formula",
      "name": "filter",
      "default": "",
      "description": "The formula will be evaluated for each record. <a href=\"https://learn.microsoft.com/en-us/graph/filter-query-parameter\">More info</a>.",
      "hint": "If empty, all the items will be returned",
      "placeholder": "e.g. fields/Title eq 'item1'",
      "routing": {
        "send": {
          "property": "$filter",
          "type": "query",
          "value": "={{ $value ? $value : undefined }}"
        }
      },
      "type": "string",
      "displayOptions": {
        "show": {
          "resource": [
            "item"
          ],
          "operation": [
            "getAll"
          ]
        }
      },
      "ai_hint": "The formula will be evaluated for each record. <a href=\"https://learn.microsoft.com/en-us/graph/filter-query-parameter\">More info</a>."
    },
    "returnAll": {
      "displayName": "Return All",
      "name": "returnAll",
      "default": false,
      "description": "Whether to return all results or only up to a given limit",
      "routing": {
        "send": {
          "paginate": "={{ $value }}"
        },
        "operations": {
          "pagination": {
            "type": "generic",
            "properties": {
              "continue": "={{ !!$response.body?.[\"@odata.nextLink\"] }}",
              "request": {
                "url": "={{ $response.body?.[\"@odata.nextLink\"] ?? $request.url }}",
                "qs": {
                  "$select": "={{ !!$response.body?.[\"@odata.nextLink\"] ? undefined : $request.qs?.$select }}"
                }
              }
            }
          }
        }
      },
      "type": "boolean",
      "displayOptions": {
        "show": {
          "resource": [
            "list"
          ],
          "operation": [
            "getAll"
          ]
        }
      },
      "ai_hint": "布尔值：true 或 false。"
    },
    "limit": {
      "displayName": "Limit",
      "name": "limit",
      "default": 50,
      "description": "Max number of results to return",
      "displayOptions": {
        "show": {
          "returnAll": [
            false
          ],
          "resource": [
            "list"
          ],
          "operation": [
            "getAll"
          ]
        }
      },
      "routing": {
        "send": {
          "property": "$top",
          "type": "query",
          "value": "={{ $value }}"
        }
      },
      "type": "number",
      "typeOptions": {
        "minValue": 1
      },
      "validateType": "number",
      "ai_hint": "Max number of results to return"
    },
    "options": {
      "displayName": "Options",
      "name": "options",
      "default": {},
      "options": [
        {
          "displayName": "Fields",
          "name": "fields",
          "default": [],
          "description": "The fields you want to include in the output",
          "displayOptions": {
            "hide": {
              "/simplify": [
                true
              ]
            }
          },
          "options": [
            {
              "name": "Content Type",
              "value": "contentType"
            },
            {
              "name": "Created At",
              "value": "createdDateTime"
            },
            {
              "name": "Created By",
              "value": "createdBy"
            },
            {
              "name": "Fields",
              "value": "fields"
            },
            {
              "name": "ID",
              "value": "id"
            },
            {
              "name": "Last Modified At",
              "value": "lastModifiedDateTime"
            },
            {
              "name": "Last Modified By",
              "value": "lastModifiedBy"
            },
            {
              "name": "Parent Reference",
              "value": "parentReference"
            },
            {
              "name": "Web URL",
              "value": "webUrl"
            }
          ],
          "routing": {
            "send": {
              "preSend": [
                null
              ]
            }
          },
          "type": "multiOptions"
        }
      ],
      "placeholder": "Add option",
      "type": "collection",
      "displayOptions": {
        "show": {
          "resource": [
            "item"
          ],
          "operation": [
            "getAll"
          ]
        }
      },
      "ai_hint": "此参数为 fixedCollection，包含嵌套字段，不要扁平化。"
    },
    "requestOptions": {
      "displayName": "Request Options",
      "name": "requestOptions",
      "type": "collection",
      "isNodeSetting": true,
      "placeholder": "Add Option",
      "default": {},
      "options": [
        {
          "displayName": "Batching",
          "name": "batching",
          "placeholder": "Add Batching",
          "type": "fixedCollection",
          "typeOptions": {
            "multipleValues": false
          },
          "default": {
            "batch": {}
          },
          "options": [
            {
              "displayName": "Batching",
              "name": "batch",
              "values": [
                {
                  "displayName": "Items per Batch",
                  "name": "batchSize",
                  "type": "number",
                  "typeOptions": {
                    "minValue": -1
                  },
                  "default": 50,
                  "description": "Input will be split in batches to throttle requests. -1 for disabled. 0 will be treated as 1."
                },
                {
                  "displayName": "Batch Interval (ms)",
                  "name": "batchInterval",
                  "type": "number",
                  "typeOptions": {
                    "minValue": 0
                  },
                  "default": 1000,
                  "description": "Time (in milliseconds) between each batch of requests. 0 for disabled."
                }
              ]
            }
          ]
        },
        {
          "displayName": "Ignore SSL Issues (Insecure)",
          "name": "allowUnauthorizedCerts",
          "type": "boolean",
          "noDataExpression": true,
          "default": false,
          "description": "Whether to accept the response even if SSL certificate validation is not possible"
        },
        {
          "displayName": "Proxy",
          "name": "proxy",
          "type": "string",
          "default": "",
          "placeholder": "e.g. http://myproxy:3128",
          "description": "HTTP proxy to use. If authentication is required it can be defined as follow: http://username:password@myproxy:3128"
        },
        {
          "displayName": "Timeout",
          "name": "timeout",
          "type": "number",
          "typeOptions": {
            "minValue": 1
          },
          "default": 10000,
          "description": "Time in ms to wait for the server to send response headers (and start the response body) before aborting the request"
        }
      ],
      "ai_hint": "此参数为 fixedCollection，包含嵌套字段，不要扁平化。"
    }
  },
  "configuration_logic": {
    "required_sequence": [
      "descriptionType",
      "toolDescription",
      "resource",
      "operation",
      "site",
      "folder",
      "file",
      "site",
      "folder",
      "file",
      "fileName",
      "changeFileContent",
      "fileContents",
      "site",
      "folder",
      "fileName",
      "fileContents",
      "operation",
      "site",
      "list",
      "noticeUnsupportedFields",
      "columns",
      "site",
      "list",
      "item",
      "site",
      "list",
      "item",
      "simplify",
      "site",
      "list",
      "filter",
      "returnAll",
      "limit",
      "options",
      "simplify",
      "site",
      "list",
      "noticeUnsupportedFields",
      "columns",
      "site",
      "list",
      "noticeUnsupportedFields",
      "columns",
      "operation",
      "site",
      "list",
      "simplify",
      "site",
      "returnAll",
      "limit",
      "simplify",
      "requestOptions"
    ],
    "conditional_rules": [
      "IF descriptionType == 'manual' THEN SHOW parameter 'toolDescription'",
      "IF resource == 'file' THEN SHOW parameter 'operation'",
      "IF resource == 'file' AND operation == 'download' THEN SHOW parameter 'site'",
      "IF resource == 'file' AND operation == 'download' THEN SHOW parameter 'folder'",
      "IF site == '' THEN HIDE parameter 'folder'",
      "IF resource == 'file' AND operation == 'download' THEN SHOW parameter 'file'",
      "IF site == '' AND folder == '' THEN HIDE parameter 'file'",
      "IF resource == 'file' AND operation == 'update' THEN SHOW parameter 'site'",
      "IF resource == 'file' AND operation == 'update' THEN SHOW parameter 'folder'",
      "IF resource == 'file' AND operation == 'update' THEN SHOW parameter 'file'",
      "IF resource == 'file' AND operation == 'update' THEN SHOW parameter 'fileName'",
      "IF resource == 'file' AND operation == 'update' THEN SHOW parameter 'changeFileContent'",
      "IF changeFileContent == True AND resource == 'file' AND operation == 'update' THEN SHOW parameter 'fileContents'",
      "IF resource == 'file' AND operation == 'upload' THEN SHOW parameter 'site'",
      "IF resource == 'file' AND operation == 'upload' THEN SHOW parameter 'folder'",
      "IF resource == 'file' AND operation == 'upload' THEN SHOW parameter 'fileName'",
      "IF resource == 'file' AND operation == 'upload' THEN SHOW parameter 'fileContents'",
      "IF resource == 'item' THEN SHOW parameter 'operation'",
      "IF resource == 'item' AND operation == 'create' THEN SHOW parameter 'site'",
      "IF resource == 'item' AND operation == 'create' THEN SHOW parameter 'list'",
      "IF site == '' THEN HIDE parameter 'list'",
      "IF resource == 'item' AND operation == 'create' THEN SHOW parameter 'noticeUnsupportedFields'",
      "IF site == '' AND list == '' THEN HIDE parameter 'noticeUnsupportedFields'",
      "IF resource == 'item' AND operation == 'create' THEN SHOW parameter 'columns'",
      "IF site == '' AND list == '' THEN HIDE parameter 'columns'",
      "IF resource == 'item' AND operation == 'delete' THEN SHOW parameter 'site'",
      "IF resource == 'item' AND operation == 'delete' THEN SHOW parameter 'list'",
      "IF resource == 'item' AND operation == 'delete' THEN SHOW parameter 'item'",
      "IF site == '' AND list == '' THEN HIDE parameter 'item'",
      "IF resource == 'item' AND operation == 'get' THEN SHOW parameter 'site'",
      "IF resource == 'item' AND operation == 'get' THEN SHOW parameter 'list'",
      "IF resource == 'item' AND operation == 'get' THEN SHOW parameter 'item'",
      "IF resource == 'item' AND operation == 'get' THEN SHOW parameter 'simplify'",
      "IF resource == 'item' AND operation == 'getAll' THEN SHOW parameter 'site'",
      "IF resource == 'item' AND operation == 'getAll' THEN SHOW parameter 'list'",
      "IF resource == 'item' AND operation == 'getAll' THEN SHOW parameter 'filter'",
      "IF resource == 'item' AND operation == 'getAll' THEN SHOW parameter 'returnAll'",
      "IF returnAll == False AND resource == 'item' AND operation == 'getAll' THEN SHOW parameter 'limit'",
      "IF resource == 'item' AND operation == 'getAll' THEN SHOW parameter 'options'",
      "IF /simplify == True THEN HIDE parameter 'fields'",
      "IF resource == 'item' AND operation == 'getAll' THEN SHOW parameter 'simplify'",
      "IF resource == 'item' AND operation == 'update' THEN SHOW parameter 'site'",
      "IF resource == 'item' AND operation == 'update' THEN SHOW parameter 'list'",
      "IF resource == 'item' AND operation == 'update' THEN SHOW parameter 'noticeUnsupportedFields'",
      "IF resource == 'item' AND operation == 'update' THEN SHOW parameter 'columns'",
      "IF resource == 'item' AND operation == 'upsert' THEN SHOW parameter 'site'",
      "IF resource == 'item' AND operation == 'upsert' THEN SHOW parameter 'list'",
      "IF resource == 'item' AND operation == 'upsert' THEN SHOW parameter 'noticeUnsupportedFields'",
      "IF resource == 'item' AND operation == 'upsert' THEN SHOW parameter 'columns'",
      "IF resource == 'list' THEN SHOW parameter 'operation'",
      "IF resource == 'list' AND operation == 'get' THEN SHOW parameter 'site'",
      "IF resource == 'list' AND operation == 'get' THEN SHOW parameter 'list'",
      "IF resource == 'list' AND operation == 'get' THEN SHOW parameter 'simplify'",
      "IF resource == 'list' AND operation == 'getAll' THEN SHOW parameter 'site'",
      "IF resource == 'list' AND operation == 'getAll' THEN SHOW parameter 'returnAll'",
      "IF returnAll == False AND resource == 'list' AND operation == 'getAll' THEN SHOW parameter 'limit'",
      "IF resource == 'list' AND operation == 'getAll' THEN SHOW parameter 'simplify'"
    ]
  }
}