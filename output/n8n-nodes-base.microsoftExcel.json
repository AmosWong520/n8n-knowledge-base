{
  "node_id": "n8n-nodes-base.microsoftExcel",
  "name": "n8n-nodes-base.microsoftExcel",
  "version": 1,
  "semantic_context": "Consume Microsoft Excel API",
  "parameters": {
    "oldVersionNotice": {
      "displayName": "<strong>New node version available:</strong> get the latest version with added features from the nodes panel.",
      "name": "oldVersionNotice",
      "type": "notice",
      "default": ""
    },
    "resource": {
      "displayName": "Resource",
      "name": "resource",
      "type": "options",
      "noDataExpression": true,
      "options": [
        {
          "name": "Table",
          "value": "table",
          "description": "Represents an Excel table"
        },
        {
          "name": "Workbook",
          "value": "workbook",
          "description": "Workbook is the top level object which contains related workbook objects such as worksheets, tables, ranges, etc"
        },
        {
          "name": "Worksheet",
          "value": "worksheet",
          "description": "An Excel worksheet is a grid of cells. It can contain data, tables, charts, etc."
        }
      ],
      "default": "workbook",
      "ai_hint": "根据 REST 规范选择方法: 查询用 GET，创建用 POST，更新用 PUT/PATCH。"
    },
    "operation": {
      "displayName": "Operation",
      "name": "operation",
      "type": "options",
      "noDataExpression": true,
      "displayOptions": {
        "show": {
          "resource": [
            "table"
          ]
        }
      },
      "options": [
        {
          "name": "Add Row",
          "value": "addRow",
          "description": "Adds rows to the end of the table",
          "action": "Add a row"
        },
        {
          "name": "Get Columns",
          "value": "getColumns",
          "description": "Retrieve a list of tablecolumns",
          "action": "Get columns"
        },
        {
          "name": "Get Rows",
          "value": "getRows",
          "description": "Retrieve a list of tablerows",
          "action": "Get rows"
        },
        {
          "name": "Lookup",
          "value": "lookup",
          "description": "Looks for a specific column value and then returns the matching row",
          "action": "Look up a column"
        }
      ],
      "default": "addRow",
      "ai_hint": "根据 REST 规范选择方法: 查询用 GET，创建用 POST，更新用 PUT/PATCH。"
    },
    "workbook": {
      "displayName": "Workbook Name or ID",
      "name": "workbook",
      "type": "options",
      "description": "Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>",
      "required": true,
      "typeOptions": {
        "loadOptionsMethod": "getWorkbooks"
      },
      "displayOptions": {
        "show": {
          "operation": [
            "lookup"
          ],
          "resource": [
            "table"
          ]
        }
      },
      "default": "",
      "ai_hint": "Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>"
    },
    "additionalFields": {
      "displayName": "Additional Fields",
      "name": "additionalFields",
      "type": "collection",
      "placeholder": "Add Field",
      "default": {},
      "displayOptions": {
        "show": {
          "operation": [
            "addRow"
          ],
          "resource": [
            "table"
          ]
        }
      },
      "options": [
        {
          "displayName": "Index",
          "name": "index",
          "type": "number",
          "default": 0,
          "typeOptions": {
            "minValue": 0
          },
          "description": "Specifies the relative position of the new row. If not defined, the addition happens at the end. Any rows below the inserted row are shifted downwards. Zero-indexed"
        }
      ],
      "ai_hint": "此参数为 fixedCollection，包含嵌套字段，不要扁平化。"
    },
    "returnAll": {
      "displayName": "Return All",
      "name": "returnAll",
      "type": "boolean",
      "displayOptions": {
        "show": {
          "operation": [
            "getColumns"
          ],
          "resource": [
            "table"
          ]
        }
      },
      "default": false,
      "description": "Whether to return all results or only up to a given limit",
      "ai_hint": "布尔值：true 或 false。"
    },
    "limit": {
      "displayName": "Limit",
      "name": "limit",
      "type": "number",
      "displayOptions": {
        "show": {
          "operation": [
            "getColumns"
          ],
          "resource": [
            "table"
          ],
          "returnAll": [
            false
          ]
        }
      },
      "typeOptions": {
        "minValue": 1,
        "maxValue": 500
      },
      "default": 100,
      "description": "Max number of results to return",
      "ai_hint": "Max number of results to return"
    },
    "filters": {
      "displayName": "Filters",
      "name": "filters",
      "type": "collection",
      "placeholder": "Add Filter",
      "default": {},
      "displayOptions": {
        "show": {
          "operation": [
            "getColumns"
          ],
          "resource": [
            "table"
          ],
          "rawData": [
            true
          ]
        }
      },
      "options": [
        {
          "displayName": "Fields",
          "name": "fields",
          "type": "string",
          "default": "",
          "description": "Fields the response will containt. Multiple can be added separated by ,."
        }
      ],
      "ai_hint": "此参数为 fixedCollection，包含嵌套字段，不要扁平化。"
    },
    "worksheet": {
      "displayName": "Worksheet Name or ID",
      "name": "worksheet",
      "type": "options",
      "description": "Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>",
      "required": true,
      "typeOptions": {
        "loadOptionsMethod": "getworksheets",
        "loadOptionsDependsOn": [
          "workbook"
        ]
      },
      "displayOptions": {
        "show": {
          "operation": [
            "lookup"
          ],
          "resource": [
            "table"
          ]
        }
      },
      "default": "",
      "ai_hint": "Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>"
    },
    "range": {
      "displayName": "Range",
      "name": "range",
      "type": "string",
      "displayOptions": {
        "show": {
          "operation": [
            "getContent"
          ],
          "resource": [
            "worksheet"
          ]
        }
      },
      "default": "A1:C3",
      "required": true,
      "description": "The address or the name of the range. If not specified, the entire worksheet range is returned.",
      "ai_hint": "The address or the name of the range. If not specified, the entire worksheet range is returned."
    },
    "rawData": {
      "displayName": "RAW Data",
      "name": "rawData",
      "type": "boolean",
      "displayOptions": {
        "show": {
          "operation": [
            "getColumns"
          ],
          "resource": [
            "table"
          ]
        }
      },
      "default": false,
      "description": "Whether the data should be returned RAW instead of parsed into keys according to their header",
      "ai_hint": "布尔值：true 或 false。"
    },
    "dataProperty": {
      "displayName": "Data Property",
      "name": "dataProperty",
      "type": "string",
      "default": "data",
      "displayOptions": {
        "show": {
          "operation": [
            "getColumns"
          ],
          "resource": [
            "table"
          ],
          "rawData": [
            true
          ]
        }
      },
      "description": "The name of the property into which to write the RAW data",
      "ai_hint": "The name of the property into which to write the RAW data"
    },
    "dataStartRow": {
      "displayName": "Data Start Row",
      "name": "dataStartRow",
      "type": "number",
      "typeOptions": {
        "minValue": 1
      },
      "default": 1,
      "displayOptions": {
        "show": {
          "operation": [
            "getContent"
          ],
          "resource": [
            "worksheet"
          ]
        },
        "hide": {
          "rawData": [
            true
          ]
        }
      },
      "description": "Index of the first row which contains the actual data and not the keys. Starts with 0.",
      "ai_hint": "Index of the first row which contains the actual data and not the keys. Starts with 0."
    },
    "keyRow": {
      "displayName": "Key Row",
      "name": "keyRow",
      "type": "number",
      "typeOptions": {
        "minValue": 0
      },
      "displayOptions": {
        "show": {
          "operation": [
            "getContent"
          ],
          "resource": [
            "worksheet"
          ]
        },
        "hide": {
          "rawData": [
            true
          ]
        }
      },
      "default": 0,
      "description": "Index of the row which contains the keys. Starts at 0. The incoming node data is matched to the keys for assignment. The matching is case sensitve.",
      "ai_hint": "Index of the row which contains the keys. Starts at 0. The incoming node data is matched to the keys for assignment. The matching is case sensitve."
    },
    "table": {
      "displayName": "Table Name or ID",
      "name": "table",
      "type": "options",
      "description": "Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>",
      "required": true,
      "typeOptions": {
        "loadOptionsMethod": "getTables",
        "loadOptionsDependsOn": [
          "worksheet"
        ]
      },
      "displayOptions": {
        "show": {
          "operation": [
            "lookup"
          ],
          "resource": [
            "table"
          ]
        }
      },
      "default": "",
      "ai_hint": "Choose from the list, or specify an ID using an <a href=\"https://docs.n8n.io/code/expressions/\">expression</a>"
    },
    "lookupColumn": {
      "displayName": "Lookup Column",
      "name": "lookupColumn",
      "type": "string",
      "default": "",
      "placeholder": "Email",
      "required": true,
      "displayOptions": {
        "show": {
          "resource": [
            "table"
          ],
          "operation": [
            "lookup"
          ]
        }
      },
      "description": "The name of the column in which to look for value",
      "ai_hint": "The name of the column in which to look for value"
    },
    "lookupValue": {
      "displayName": "Lookup Value",
      "name": "lookupValue",
      "type": "string",
      "default": "",
      "placeholder": "frank@example.com",
      "required": true,
      "displayOptions": {
        "show": {
          "resource": [
            "table"
          ],
          "operation": [
            "lookup"
          ]
        }
      },
      "description": "The value to look for in column",
      "ai_hint": "The value to look for in column"
    },
    "options": {
      "displayName": "Options",
      "name": "options",
      "type": "collection",
      "placeholder": "Add option",
      "default": {},
      "displayOptions": {
        "show": {
          "resource": [
            "table"
          ],
          "operation": [
            "lookup"
          ]
        }
      },
      "options": [
        {
          "displayName": "Return All Matches",
          "name": "returnAllMatches",
          "type": "boolean",
          "default": false,
          "description": "By default only the first result gets returned. If options gets set all found matches get returned."
        }
      ],
      "ai_hint": "此参数为 fixedCollection，包含嵌套字段，不要扁平化。"
    }
  },
  "configuration_logic": {
    "required_sequence": [
      "oldVersionNotice",
      "resource",
      "operation",
      "workbook",
      "additionalFields",
      "returnAll",
      "limit",
      "filters",
      "operation",
      "workbook",
      "returnAll",
      "limit",
      "filters",
      "workbook",
      "worksheet",
      "range",
      "rawData",
      "dataProperty",
      "dataStartRow",
      "keyRow",
      "filters",
      "operation",
      "workbook",
      "worksheet",
      "table",
      "additionalFields",
      "workbook",
      "worksheet",
      "table",
      "returnAll",
      "limit",
      "rawData",
      "dataProperty",
      "filters",
      "workbook",
      "worksheet",
      "table",
      "returnAll",
      "limit",
      "rawData",
      "dataProperty",
      "filters",
      "workbook",
      "worksheet",
      "table",
      "lookupColumn",
      "lookupValue",
      "options"
    ],
    "conditional_rules": [
      "IF resource == 'workbook' THEN SHOW parameter 'operation'",
      "IF operation == 'addWorksheet' AND resource == 'workbook' THEN SHOW parameter 'workbook'",
      "IF operation == 'addWorksheet' AND resource == 'workbook' THEN SHOW parameter 'additionalFields'",
      "IF operation == 'getAll' AND resource == 'workbook' THEN SHOW parameter 'returnAll'",
      "IF operation == 'getAll' AND resource == 'workbook' AND returnAll == False THEN SHOW parameter 'limit'",
      "IF operation == 'getAll' AND resource == 'workbook' THEN SHOW parameter 'filters'",
      "IF resource == 'worksheet' THEN SHOW parameter 'operation'",
      "IF operation == 'getAll' AND resource == 'worksheet' THEN SHOW parameter 'workbook'",
      "IF operation == 'getAll' AND resource == 'worksheet' THEN SHOW parameter 'returnAll'",
      "IF operation == 'getAll' AND resource == 'worksheet' AND returnAll == False THEN SHOW parameter 'limit'",
      "IF operation == 'getAll' AND resource == 'worksheet' THEN SHOW parameter 'filters'",
      "IF operation == 'getContent' AND resource == 'worksheet' THEN SHOW parameter 'workbook'",
      "IF operation == 'getContent' AND resource == 'worksheet' THEN SHOW parameter 'worksheet'",
      "IF operation == 'getContent' AND resource == 'worksheet' THEN SHOW parameter 'range'",
      "IF operation == 'getContent' AND resource == 'worksheet' THEN SHOW parameter 'rawData'",
      "IF operation == 'getContent' AND resource == 'worksheet' AND rawData == True THEN SHOW parameter 'dataProperty'",
      "IF operation == 'getContent' AND resource == 'worksheet' THEN SHOW parameter 'dataStartRow'",
      "IF rawData == True THEN HIDE parameter 'dataStartRow'",
      "IF operation == 'getContent' AND resource == 'worksheet' THEN SHOW parameter 'keyRow'",
      "IF rawData == True THEN HIDE parameter 'keyRow'",
      "IF operation == 'getContent' AND resource == 'worksheet' AND rawData == True THEN SHOW parameter 'filters'",
      "IF resource == 'table' THEN SHOW parameter 'operation'",
      "IF operation == 'addRow' AND resource == 'table' THEN SHOW parameter 'workbook'",
      "IF operation == 'addRow' AND resource == 'table' THEN SHOW parameter 'worksheet'",
      "IF operation == 'addRow' AND resource == 'table' THEN SHOW parameter 'table'",
      "IF operation == 'addRow' AND resource == 'table' THEN SHOW parameter 'additionalFields'",
      "IF operation == 'getRows' AND resource == 'table' THEN SHOW parameter 'workbook'",
      "IF operation == 'getRows' AND resource == 'table' THEN SHOW parameter 'worksheet'",
      "IF operation == 'getRows' AND resource == 'table' THEN SHOW parameter 'table'",
      "IF operation == 'getRows' AND resource == 'table' THEN SHOW parameter 'returnAll'",
      "IF operation == 'getRows' AND resource == 'table' AND returnAll == False THEN SHOW parameter 'limit'",
      "IF operation == 'getRows' AND resource == 'table' THEN SHOW parameter 'rawData'",
      "IF operation == 'getRows' AND resource == 'table' AND rawData == True THEN SHOW parameter 'dataProperty'",
      "IF operation == 'getRows' AND resource == 'table' AND rawData == True THEN SHOW parameter 'filters'",
      "IF operation == 'getColumns' AND resource == 'table' THEN SHOW parameter 'workbook'",
      "IF operation == 'getColumns' AND resource == 'table' THEN SHOW parameter 'worksheet'",
      "IF operation == 'getColumns' AND resource == 'table' THEN SHOW parameter 'table'",
      "IF operation == 'getColumns' AND resource == 'table' THEN SHOW parameter 'returnAll'",
      "IF operation == 'getColumns' AND resource == 'table' AND returnAll == False THEN SHOW parameter 'limit'",
      "IF operation == 'getColumns' AND resource == 'table' THEN SHOW parameter 'rawData'",
      "IF operation == 'getColumns' AND resource == 'table' AND rawData == True THEN SHOW parameter 'dataProperty'",
      "IF operation == 'getColumns' AND resource == 'table' AND rawData == True THEN SHOW parameter 'filters'",
      "IF operation == 'lookup' AND resource == 'table' THEN SHOW parameter 'workbook'",
      "IF operation == 'lookup' AND resource == 'table' THEN SHOW parameter 'worksheet'",
      "IF operation == 'lookup' AND resource == 'table' THEN SHOW parameter 'table'",
      "IF resource == 'table' AND operation == 'lookup' THEN SHOW parameter 'lookupColumn'",
      "IF resource == 'table' AND operation == 'lookup' THEN SHOW parameter 'lookupValue'",
      "IF resource == 'table' AND operation == 'lookup' THEN SHOW parameter 'options'"
    ]
  }
}